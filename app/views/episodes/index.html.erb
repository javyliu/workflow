<% if @episodes.present? %>
<table>
  <thead>
    <tr>
      <th>名字</th>
      <th>类别</th>
      <th>开始时间</th>
      <th>结束时间</th>
      <th>申请时长</th>
      <th>事由</th>
      <th>审批结果</th>
      <th></th>
    </tr>
  </thead>

  <tbody>
  <% @episodes.each do |episode| %>
  <tr>
    <td><%= episode.user.user_name %></td>
    <td><%= episode.holiday.name %></td>
    <td><%= episode.start_date %></td>
    <td><%= episode.end_date %></td>
    <td><%= episode.total_time %><%= episode.holiday.unit %></td>
    <td><%= episode.comment %></td>
    <td><%= episode.state %></td>
    <td><%= link_to('编辑', edit_episode_path(episode)) if episode.object.state.in?([0,2]) %></td>
  </tr>
  <% end %>
  <tr>
    <td colspan=8>
      <%= paginate @episodes %>
    </td>
  </tr>
  </tbody>
</table>
<% end %>
<div class="panel">
  <h4>提交申请</h4>
  <% cache [:holiday,current_user.dept_group.first] do %>
  <% Holiday.where(id: current_user.dept_group.second).each do |item|  %>
  <%= link_to "申请#{item.name}", new_episode_path(item.id),class: "button medium" %>
  <% end %>

  <% end %>
</div>

